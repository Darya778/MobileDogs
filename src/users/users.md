## Функции для работы с пользователями

1. `create_user(user: UserCreate, db: Session = Depends(get_db))`

Описание: Эта функция отвечает за регистрацию новых пользователей.

Параметры:

* `user: UserCreate`: Данные нового пользователя, которые передаются в виде объекта `UserCreate`.
* `db: Session`: Сессия базы данных, полученная из контекста зависимости `get_db`.

Действия:

1. Хеширует пароль пользователя с помощью функции `get_password_hash`.
2. Создает словарь `user_data` из объекта `user`, исключая поле `deletion_date`.
3. Заменяет поле `password` в словаре `user_data` на хешированный пароль.
4. Вызывает функцию `db_manager.add_user` для добавления нового пользователя в базу данных.
5. Если функция `db_manager.add_user` возвращает `user_id` равный 0, то это означает ошибку. В этом случае функция записывает ошибку в лог с помощью функции `log_message` и генерирует исключение `HTTPException` с кодом 500 и описанием ошибки.
6. Если функция `db_manager.add_user` успешно добавляет пользователя, функция записывает информацию об успешной регистрации в лог и возвращает `user_id` и сообщение об успешной регистрации.
7. Обрабатывает любые исключения, возникшие в процессе регистрации, записывает их в лог и генерирует исключение `HTTPException` с кодом 500 и описанием ошибки.

2. `update_user(user_id: int, user_update: UserUpdate, db: Session = Depends(get_db))`

Описание: Эта функция отвечает за обновление данных существующего пользователя.

Параметры:

* `user_id: int`: ID пользователя, которого нужно обновить.
* `user_update: UserUpdate`: Данные для обновления, которые передаются в виде объекта `UserUpdate`.
* `db: Session`: Сессия базы данных, полученная из контекста зависимости `get_db`.

Действия:

1. Вызывает функцию `db_manager.update_user` для обновления данных пользователя в базе данных.
2. Если функция `db_manager.update_user` успешно обновляет данные, функция записывает информацию об успешном обновлении в лог и возвращает сообщение об успешном обновлении.
3. Обрабатывает любые исключения, возникшие в процессе обновления, записывает их в лог и генерирует исключение `HTTPException` с кодом 500 и описанием ошибки.

3. `delete_user(user_id: int, db: Session = Depends(get_db))`

Описание: Эта функция отвечает за удаление (архивацию) пользователя.

Параметры:

* `user_id: int`: ID пользователя, которого нужно удалить.
* `db: Session`: Сессия базы данных, полученная из контекста зависимости `get_db`.

Действия:

1. Вызывает функцию `db_manager.archive_user` для архивирования пользователя в базе данных.
2. Если функция `db_manager.archive_user` успешно архивирует пользователя, функция записывает информацию об успешном удалении в лог и возвращает сообщение об успешном удалении.
3. Обрабатывает любые исключения, возникшие в процессе удаления, записывает их в лог и генерирует исключение `HTTPException` с кодом 500 и описанием ошибки.

### Дополнительные замечания:

* `db_manager`: Класс, который предоставляет функции для взаимодействия с базой данных.
* `log_message`:  Функция для записи сообщений в лог-файл.
* `get_password_hash`:  Функция для хеширования паролей.
* `HTTPException`:  Это исключение используется для генерации ответа HTTP с кодом ошибки.

### Пример использования:
```
# Регистрация нового пользователя
user_data = UserCreate(login="JohnDoe", password="password123", email="johndoe@example.com", ...)
user_id, message = create_user(user_data, db)

# Обновление данных пользователя
user_update_data = UserUpdate(phone="88001234567")
update_user(user_id, user_update_data, db)

# Удаление (архивирование) пользователя
delete_user(user_id, db)
```